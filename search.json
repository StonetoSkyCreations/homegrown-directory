---
layout: null
permalink: /search.json
---
[
{% assign all = site.farms | concat: site.markets | concat: site.stores | concat: site.restaurants | concat: site.distributors | concat: site.vendors %}
{% for doc in all %}
  {% assign display_type = doc.collection | capitalize %}
  {% assign type_token = doc.collection %}
  {% assign subtype_raw = doc.type | default: doc.listing_type | default: doc.category %}
  {% case doc.collection %}
    {% when 'stores' %}
      {% assign display_type = 'Grocer' %}
      {% assign type_token = 'grocer' %}
    {% when 'restaurants' %}
      {% assign display_type = 'Eatery' %}
      {% assign type_token = 'restaurant' %}
    {% when 'vendors' %}
      {% assign display_type = 'Eatery' %}
      {% assign type_token = 'restaurant' %}
    {% when 'distributors' %}
      {% assign display_type = 'Hub' %}
      {% assign type_token = 'distributor' %}
    {% when 'farms' %}
      {% assign type_token = 'farm' %}
    {% when 'markets' %}
      {% assign type_token = 'market' %}
  {% endcase %}
  {% assign subtype_token = subtype_raw | default: type_token | slugify %}
  {
    "id": "{{ doc.id | default: doc.slug | slugify }}",
    "title": {{ doc.title | default: doc.name | jsonify }},
    "name": {{ doc.name | default: doc.title | jsonify }},
    "collection": "{{ doc.collection }}",
    "type": "{{ display_type }}",
    "type_token": "{{ type_token }}",
    "subtype": {{ subtype_raw | default: type_token | jsonify }},
    "subtype_token": "{{ subtype_token }}",
    "slug": "{{ doc.slug }}",
    "url": "{{ doc.url | relative_url }}",
    "country": {{ doc.country | jsonify }},
    "country_slug": {{ doc.country_slug | jsonify }},
    "region": {{ doc.region | jsonify }},
    "city": {{ doc.city | jsonify }},
    "practices": {{ doc.practices | jsonify }},
    "products": {{ doc.products | jsonify }},
    "services": {{ doc.services | jsonify }},
    "supplies_to": {{ doc.supplies_to | jsonify }},
    "sources": {{ doc.sources | jsonify }},
    "hours": {{ doc.hours | jsonify }},
    "lat": {{ doc.lat | jsonify }},
    "lon": {{ doc.lon | jsonify }},
    "featured": {{ doc.featured | default: false | jsonify }},
    "description": {{ doc.description | default: doc.excerpt | strip_html | strip_newlines | jsonify }}
  }{% unless forloop.last %},{% endunless %}
{% endfor %}
]
