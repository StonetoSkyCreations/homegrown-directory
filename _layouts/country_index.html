<!-- Layout for showing all listings in a given country, grouped by collection type. -->
---
layout: default
---
<section class="country-index">
  <header class="country-index__header">
    <h1>{{ page.title }}</h1>
    <p>Explore farms, markets, stores, restaurants, and distributors contributing to transparent food systems in {{ page.title }}.</p>
  </header>

  <div class="country-index__content">
    {% assign collection_map = 'Farms:farms,Markets:markets,Stores:stores,Restaurants:restaurants,Distributors:distributors' | split: ',' %}
    {% for entry in collection_map %}
      {% assign parts = entry | split: ':' %}
      {% assign label = parts[0] %}
      {% assign key = parts[1] %}
      {% assign items = site[key] | where: 'country', page.title | sort: 'title' %}
      <section class="country-section">
        <div class="country-section__header">
          <h2>{{ label }}</h2>
          <p class="muted">{{ items.size }} listing{% if items.size != 1 %}s{% endif %}</p>
        </div>
        {% if items.size > 0 %}
        <div class="listing-grid">
          {% for listing in items %}
            {% include listing-card.html listing=listing %}
          {% endfor %}
        </div>
        {% else %}
        <p class="muted">No listings added yet. Contribute one to get started.</p>
        {% endif %}
      </section>
    {% endfor %}
  </div>
</section>
