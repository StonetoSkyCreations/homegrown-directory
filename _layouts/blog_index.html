---
layout: default
---
{% assign posts = site.posts | sort: 'date' | reverse %}
{% assign per_page = page.per_page | default: 10 %}
{% assign page_num = page.page_num | default: 1 %}
{% assign total_posts = posts | size %}
{% assign offset = per_page | times: page_num | minus: per_page %}
{% assign paginated_posts = posts | slice: offset, per_page %}
{% assign total_pages = total_posts | divided_by: per_page %}
{% assign page_capacity = total_pages | times: per_page %}
{% if total_posts > page_capacity %}
  {% assign total_pages = total_pages | plus: 1 %}
{% endif %}

<section class="blog">
  <header class="blog__header">
    <p class="eyebrow">Insights & Stories</p>
    <h1>Blog</h1>
    <p class="muted">Positive stories and practical guides for organic, regenerative, spray-free, biodynamic, and ethical food systems.</p>
    <div class="blog__actions">
      {% if page.cta_button %}
      <a class="button ghost" href="{{ '/blog/submit/' | relative_url }}">Submit an article</a>
      {% endif %}
    </div>
  </header>

  <div class="blog-list">
    {% if paginated_posts and paginated_posts.size > 0 %}
      {% for post in paginated_posts %}
        <article class="blog-card">
          <p class="pill pill--type">Article</p>
          <h2><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h2>
          <p class="muted blog-card__meta">{{ post.date | date: "%-d %B %Y" }}{% if post.author %} · {{ post.author }}{% endif %}{% if post.tags %} · {{ post.tags | join: ", " }}{% endif %}</p>
          {% if post.summary %}
            <p class="blog-card__summary">{{ post.summary }}</p>
          {% endif %}
          {% if post.tags %}
            <p class="blog-card__tags">
              {% for tag in post.tags %}
                <span class="pill pill--tag">{{ tag }}</span>
              {% endfor %}
            </p>
          {% endif %}
        </article>
      {% endfor %}
    {% else %}
      <p class="muted">No articles yet. Check back soon.</p>
    {% endif %}
  </div>

  {% if total_pages > 1 %}
    {% assign prev_page = page_num | minus: 1 %}
    {% assign next_page = page_num | plus: 1 %}
    <nav class="pagination" aria-label="Blog pagination">
      {% if prev_page >= 1 %}
        {% if prev_page == 1 %}
          {% assign prev_href = '/blog/' %}
        {% else %}
          {% assign prev_href = '/blog/page' | append: prev_page | append: '/' %}
        {% endif %}
        <a class="button ghost" href="{{ prev_href | relative_url }}">&larr; Newer posts</a>
      {% else %}
        <span class="button ghost disabled">Newer posts</span>
      {% endif %}

      <span class="muted">Page {{ page_num }} of {{ total_pages }}</span>

      {% if next_page <= total_pages %}
        {% assign next_href = '/blog/page' | append: next_page | append: '/' %}
        <a class="button ghost" href="{{ next_href | relative_url }}">Older posts &rarr;</a>
      {% else %}
        <span class="button ghost disabled">Older posts</span>
      {% endif %}
    </nav>
  {% endif %}
</section>
