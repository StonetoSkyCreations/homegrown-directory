---
layout: default
---
{% assign items_raw = site[page.collection_key] | sort: 'title' %}
{% assign items = items_raw | where_exp: 'item', 'item.type != "brand"' %}
<section class="collection-index">
  <header class="collection-index__header">
    <p class="eyebrow">{{ page.collection_label }}</p>
    <h1>{{ page.title }}</h1>
    {% if page.intro %}<p class="lead">{{ page.intro }}</p>{% endif %}
  </header>
  <div class="collection-index__filters muted">Currently showing {{ items.size }} listing{% if items.size != 1 %}s{% endif %}.</div>
  <div class="listing-grid">
    {% for listing in items %}
      {% include listing-card.html listing=listing %}
    {% endfor %}
  </div>
</section>

{% if items and items.size > 0 %}
{%- comment -%}ItemList schema for this collection page (uses listing title + URL).{%- endcomment -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "{{ page.title | escape }}",
  "description": "{{ page.intro | default: page.description | default: site.description | strip_html | strip_newlines | escape }}",
  "url": "{{ page.url | absolute_url }}",
  "mainEntity": {
    "@type": "ItemList",
    "itemListOrder": "https://schema.org/ItemListOrderAscending",
    "numberOfItems": {{ items.size }},
    "itemListElement": [
      {% for listing in items %}
      {
        "@type": "ListItem",
        "position": {{ forloop.index }},
        "name": "{{ listing.title | default: listing.name | escape }}",
        "url": "{{ listing.url | absolute_url }}"
      }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ]
  }
}
</script>
{% endif %}
