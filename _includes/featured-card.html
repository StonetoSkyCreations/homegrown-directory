{% assign scope = include.scope | default: "global" %}
{% assign key = include.key | default: "home" %}

{% assign config = site.data.featured[scope][key] %}
{% assign requested_country = include.country_slug | default: include.country %}

{% assign coll_name = include.collection | default: config.collection %}

{% if config %}
  {% assign slug_from_config = config.slug %}
  {% if requested_country %}
    {% assign country_slug_key = "slug_" | append: requested_country %}
    {% assign slug_from_config = config[country_slug_key] | default: slug_from_config %}
  {% endif %}
{% endif %}

{% assign slug = include.slug | default: slug_from_config %}

{% if coll_name and slug %}
  {% assign coll = site[coll_name] %}
  {% assign item = coll | where: "slug", slug | first %}
{% endif %}

{% if item %}
  {% assign heading = include.heading | default: config.heading %}
  {% unless heading %}
    {% if key == "eateries" %}
      {% assign heading = "Featured eatery" %}
    {% else %}
      {% assign heading = "Featured listing" %}
    {% endif %}
  {% endunless %}
<section
  class="featured-section"
  data-featured-slug="{{ item.slug | escape }}"
  data-featured-country="{{ requested_country | default: item.country_slug | escape }}"
  data-featured-url="{{ item.url | relative_url | escape }}"
  data-featured-collection="{{ item.collection | downcase | escape }}">
  <div class="featured-card-wrapper">
    {% if heading %}<p class="eyebrow">{{ heading }}</p>{% endif %}
    {% include listing-card.html
      item=item
      featured=true
    %}
  </div>
</section>
{% endif %}
